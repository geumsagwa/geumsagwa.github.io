<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library - 생각을 잇다</title>
        <script>if(localStorage.getItem('theme')==='light')document.documentElement.classList.add('light-mode')</script>
<link rel="stylesheet" href="style.css?v=2">
<link rel="stylesheet" href="style-pages.css">
<link rel="stylesheet" href="style-light.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<!-- 상단 메뉴바 영역 -->
<nav class="menu-bar">
    <a href="index.html" class="menu-logo">
        <span class="menu-logo-text">생각을 잇다</span>
    </a>
    <ul class="menu-list">
        <li><a href="index.html">Home</a></li>
        <li class="active"><a href="library.html">Library</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="gallery.html">Gallery</a></li>
        <li><a href="board.html">Board</a></li>
        <li class="diary-menu" style="display:none"><a href="diary.html">Diary</a></li>
        <li class="admin-menu" style="display:none"><a href="admin.html">관리</a></li>
    </ul>
    <div class="auth-area" id="auth-area"></div>
</nav>

<!-- Library 콘텐츠 영역 -->
<div class="library-container">

    <!-- 테마 문구 -->
    <div class="library-theme">
        <p class="library-theme-text">'어떤' 생각은 시대를 넘어 이어진다.</p>
    </div>

    <!-- 카테고리 탭 (도서관 분류표 스타일) -->
    <div class="library-tabs">
        <button class="library-tab active" data-category="history">
            <span class="tab-label-code">Ⅰ</span>
            <span class="tab-label-name">History</span>
        </button>
        <button class="library-tab" data-category="philosophy">
            <span class="tab-label-code">Ⅱ</span>
            <span class="tab-label-name">Philosophy</span>
        </button>
        <button class="library-tab" data-category="psychology">
            <span class="tab-label-code">Ⅲ</span>
            <span class="tab-label-name">Psychology</span>
        </button>
    </div>

    <!-- 카테고리별 책 목록 (DB에서 동적 로드) -->
    <div class="library-content">
        <div class="library-panel active" data-category="history">
            <div class="bookshelf">
                <div class="shelf-row" id="shelf-history">
                    <div class="shelf-surface"></div>
                </div>
            </div>
        </div>
        <div class="library-panel" data-category="philosophy">
            <div class="bookshelf">
                <div class="shelf-row" id="shelf-philosophy">
                    <div class="shelf-surface"></div>
                </div>
            </div>
        </div>
        <div class="library-panel" data-category="psychology">
            <div class="bookshelf">
                <div class="shelf-row" id="shelf-psychology">
                    <div class="shelf-surface"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- EPUB 업로드 모달 (로그인 사용자만 표시) -->
    <div class="upload-modal" id="upload-modal">
        <div class="upload-backdrop" onclick="closeUploadModal()"></div>
        <div class="upload-card">
            <h3 class="upload-title">책 등록</h3>
            <form id="upload-form" class="upload-form">
                <div class="upload-field">
                    <label class="upload-label">제목</label>
                    <input type="text" id="upload-book-title" class="upload-input" placeholder="책 제목" required>
                </div>
                <div class="upload-field">
                    <label class="upload-label">저자</label>
                    <input type="text" id="upload-book-author" class="upload-input" placeholder="저자명" required>
                </div>
                <div class="upload-field">
                    <label class="upload-label">카테고리</label>
                    <div class="upload-category-group">
                        <button type="button" class="upload-category-btn active" data-cat="history">History</button>
                        <button type="button" class="upload-category-btn" data-cat="philosophy">Philosophy</button>
                        <button type="button" class="upload-category-btn" data-cat="psychology">Psychology</button>
                    </div>
                </div>
                <div class="upload-field">
                    <label class="upload-label">책등 색상</label>
                    <input type="color" id="upload-spine-color" class="upload-color" value="#8B4513">
                </div>
                <div class="upload-field">
                    <label class="upload-label">EPUB 파일</label>
                    <div class="upload-dropzone" id="upload-dropzone">
                        <span class="upload-dropzone-text" id="upload-dropzone-text">파일을 드래그하거나 클릭하여 선택</span>
                        <input type="file" id="upload-file" accept=".epub" hidden>
                    </div>
                    <p class="upload-message" id="upload-auto-info"></p>
                    <p class="upload-message" id="upload-duplicate-warning"></p>
                </div>
                <div class="upload-actions">
                    <button type="button" class="upload-btn upload-btn-cancel" onclick="closeUploadModal()">취소</button>
                    <button type="submit" class="upload-btn upload-btn-submit" id="upload-submit-btn">등록</button>
                </div>
                <p class="upload-message" id="upload-message"></p>
            </form>
        </div>
    </div>

    <!-- 업로드 버튼 (로그인 사용자만 표시) -->
    <button class="library-upload-btn" id="library-upload-btn" style="display:none;" onclick="openUploadModal()">+</button>

</div>

<!-- 책 펼침 애니메이션 오버레이 -->
<div class="book-open-overlay" id="book-open-overlay">
    <div class="book-open-scene">
        <div class="book-open-book" id="book-open-book">
            <!-- 왼쪽 페이지 (표지 뒷면) -->
            <div class="book-open-left">
                <div class="book-open-page-inner"></div>
            </div>
            <!-- 오른쪽 페이지 -->
            <div class="book-open-right">
                <div class="book-open-page-inner"></div>
            </div>
            <!-- 표지 (펼쳐지는 부분) -->
            <div class="book-open-cover" id="book-open-cover">
                <div class="book-open-cover-front" id="book-open-cover-front">
                    <span class="book-open-cover-title" id="book-open-title"></span>
                    <span class="book-open-cover-author" id="book-open-author"></span>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="supabase-config.js"></script>
<script src="auth.js?v=2"></script>
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script src="library.js?v=2"></script>

</body>
</html>
